window.__require=function t(e,i,n){function s(o,h){if(!i[o]){if(!e[o]){var c=o.split("/");if(c=c[c.length-1],!e[c]){var a="function"==typeof __require&&__require;if(!h&&a)return a(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+o+"'")}o=c}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){return s(e[o][1][t]||t)},u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<n.length;o++)s(n[o]);return s}({Grid:[function(t,e,i){"use strict";cc._RF.push(e,"83bcep2VlxDCKAZJVK1P+xd","Grid"),cc.Class({extends:cc.Component,properties:{highLight:cc.Node},onLoad:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){null!=t.data.honey?!0===t.mainScene.isRemoving?t.mainScene.removeSameColor(t.data):(t.mainScene.restoreHoney(),t.startHight(),t.mainScene.startMove(t.data)):t.mainScene.endMove(t.data)}),this.highLightTimer=0,this.highLight.opacity=0},init:function(t,e){this.data=t,this.data.grid=this,this.mainScene=e},stopHight:function(){this.highLightTimer=0,this.highLight.opacity=0},startHight:function(){this.highLightTimer=Date.now(),this.currentTimer=Date.now(),this.highLight.opacity=0,this.increase=!0},start:function(){},update:function(t){0!==this.highLightTimer&&Date.now()-this.currentTimer>=30&&(this.currentTimer=Date.now(),this.increase?(this.highLight.opacity+=10,this.highLight.opacity>=255&&(this.highLight.opacity=255,this.increase=!1)):(this.highLight.opacity-=10,this.highLight.opacity<=0&&(this.highLight.opacity=0,this.increase=!0)))}}),cc._RF.pop()},{}],Honey:[function(t,e,i){"use strict";cc._RF.push(e,"f3b51OYsdxJjqAs7sxNlfxm","Honey"),cc.Class({extends:cc.Component,properties:{numLabel:cc.Label,bg:cc.Node,bg_1:cc.Node,bg_2:cc.Node,bg_3:cc.Node,bg_4:cc.Node,bg_5:cc.Node,bg_6:cc.Node,bg_7:cc.Node,bg_8:cc.Node,bg_9:cc.Node,bg_10:cc.Node,bg_default:cc.Node},start:function(){},setLabel:function(t){switch(this.bg.active=this.bg_1.active=this.bg_2.active=this.bg_3.active=this.bg_4.active=this.bg_5.active=this.bg_6.active=this.bg_7.active=this.bg_8.active=this.bg_9.active=this.bg_10.active=this.bg_default.active=!1,t){case 1:this.bg.active=!0;break;case 2:this.bg_1.active=!0;break;case 4:this.bg_2.active=!0;break;case 8:this.bg_3.active=!0;break;case 16:this.bg_4.active=!0;break;case 32:this.bg_5.active=!0;break;case 64:this.bg_6.active=!0;break;case 128:this.bg_7.active=!0;break;case 256:this.bg_8.active=!0;break;case 512:this.bg_9.active=!0;break;case 1024:this.bg_10.active=!0;break;default:this.bg_default.active=!0}this.numLabel.string=""+t},show:function(t,e,i){this.setLabel(e.num),this.node.parent=t,this.node.setPosition(e.pos),this.node.setScale(0,0),this.node.opacity=255,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(1,{scale:1},{easing:"elasticOut"}).call(function(){null!=i&&i()}).start()},hide:function(){var t=this;this.node.setScale(1,1),cc.tween(this.node).to(.8,{scale:0},{easing:"elasticIn"}).call(function(){t.node.parent=null}).start()}}),cc._RF.pop()},{}],MainGame:[function(t,e,i){"use strict";cc._RF.push(e,"91c5eTWfp9Ez55LTZEDxEG9","MainGame"),cc.Class({extends:cc.Component,properties:{honeyPrefab:cc.Prefab,honeyList:[cc.Node],honeyPool:[cc.Node],gridPrefab:cc.Prefab,openList:[],closeList:[],gameOverNode:cc.Node,scoreLabel:cc.Label,coinLabel:cc.Label,gridsBg:cc.Node,container:cc.Node,gameOverScoreLabel:cc.Label,honeyNumList:[cc.Node],tip:cc.Node},showTip:function(){var t=this;!0!==this.isShowTip&&(this.tip.active=!0,this.isShowTip=!0,this.tip.opacity=0,this.tip.setPosition(0,0),cc.tween(this.tip).to(1,{opacity:255}).call(function(){setTimeout(function(){cc.tween(t.tip).to(1,{position:cc.v2(0,450),opacity:0}).call(function(){t.isShowTip=!1}).start()},1e3)}).start())},onLoad:function(){var t=this;this.randomNumberList=[1,2,4,8],this.initGrids(),this.currentMoveGrid=null,this.gameOverNode.active=!1,this.currentScore=0,this.currentCoin=0,this.coinLabel.string="COIN: "+this.currentCoin,this.scoreLabel.string="SCORE: "+this.currentScore,this.gameOverScoreLabel.string=this.currentScore;for(var e=0;e<5;e++)this.honeyNumList[e].setScale(0,0);this.gridsBg.active=!0,this.container.active=!0,this.gridsBg.setScale(0,0),cc.tween(this.gridsBg).to(1,{scale:1},{easing:"elasticOut"}).call(function(){t.preloadHoneyNum(!0),t.createRandomGrids(10)}).start(),this.isRemoving=!1,this.tip.active=!1,this.isShowTip=!1,this.tip.opacity=0,this.tip.setPosition(0,0)},onClickRefresh:function(){this.currentCoin<25?this.showTip():(this.preloadHoneyNum(!1),this.currentCoin-=25,this.coinLabel.string="COIN: "+this.currentCoin)},onClickRemoveOne:function(){if(this.currentCoin<40)this.showTip();else{var t=this.getHoneyGrids();if(0!==t.length){var e=t[Math.floor(Math.random()*t.length)];e.honey.getComponent("Honey").hide(),e.honey=null,e.num=0,this.currentCoin-=40,this.coinLabel.string="COIN: "+this.currentCoin,0===(t=this.getHoneyGrids()).length&&this.createRandomGrids(5)}}},onClickRemoveFive:function(){if(this.currentCoin<75)this.showTip();else{this.currentCoin-=75,this.coinLabel.string="COIN: "+this.currentCoin;var t=this.getHoneyGrids();if(0!==t.length){for(var e=t.length<5?t.length:5;e>0;){var i=(t=this.getHoneyGrids())[Math.floor(Math.random()*t.length)];i.honey.getComponent("Honey").hide(),i.honey=null,i.num=0,e--}0===(t=this.getHoneyGrids()).length&&this.createRandomGrids(5)}}},onClickRemoveSameColor:function(){this.currentCoin<150?this.showTip():(this.currentCoin-=150,this.coinLabel.string="COIN: "+this.currentCoin,this.isRemoving=!0)},removeSameColor:function(t){for(var e=this.getSameColorGrids(t),i=0;i<e.length;i++){var n=e[i];n.honey.getComponent("Honey").hide(),n.honey=null,n.num=0}this.isRemoving=!1,0===(e=this.getHoneyGrids()).length&&this.createRandomGrids(5)},getSameColorGrids:function(t){for(var e=[],i=0;i<this.gridList.length;i++){var n=this.gridList[i];n.num===t.num&&e.push(n)}return e},getHoneyGrids:function(){for(var t=[],e=0;e<this.gridList.length;e++){var i=this.gridList[e];null!=i.honey&&t.push(i)}return t},preloadHoneyNum:function(t){var e=this;this.randomHoneyNumList=[];for(var i=0;i<5;i++){var n=this.randomNumberList[Math.floor(Math.random()*this.randomNumberList.length)];this.randomHoneyNumList.push(n)}if(t)for(var s=0;s<5;s++)this.honeyNumList[s].getComponent("Honey").setLabel(this.randomHoneyNumList[s]),cc.tween(this.honeyNumList[s]).to(.5,{scale:1},{easing:"elasticOut"}).start();else for(var r=function(t){cc.tween(e.honeyNumList[t]).to(.5,{scale:0},{easing:"elasticIn"}).call(function(){e.honeyNumList[t].getComponent("Honey").setLabel(e.randomHoneyNumList[t]),cc.tween(e.honeyNumList[t]).to(.5,{scale:1},{easing:"elasticOut"}).start()}).start()},o=0;o<5;o++)r(o)},restart:function(){var t=this;cc.tween(this.gameOverNode).to(1,{scale:0},{easing:"elasticIn"}).call(function(){t.gameOverNode.active=!1;for(var e=0;e<t.gridList.length;e++){var i=t.gridList[e];t.honeyPool.push(i.honey),i.honey.parent=null,i.honey=null,i.num=0}t.gameOverNode.active=!1,t.currentScore=0,t.scoreLabel.string="SCORE: "+t.currentScore,t.gameOverScoreLabel.string=t.currentScore;for(var n=0;n<5;n++)t.honeyNumList[n].setScale(0,0);t.gridsBg.active=!0,t.container.active=!0,t.gridsBg.setScale(0,0),cc.tween(t.gridsBg).to(1,{scale:1},{easing:"elasticOut"}).call(function(){t.preloadHoneyNum(!0),t.createRandomGrids(10)}).start()}).start(),this.isRemoving=!1,this.tip.active=!1,this.isShowTip=!1,this.tip.opacity=0,this.tip.setPosition(0,0)},initGrids:function(){this.grids=[];var t,e,i=0;this.gridList=[];for(var n=0;n<9;n++){n<=4?(t=5+n,e=-149-37*n):(t=13-n,e=37*(n-4)-297),this.grids[n]=[];for(var s=0;s<t;s++){this.grids[n][s]={row:n,col:s,pos:cc.v2(e+74*s,270-64*n),index:i,honey:null,num:0};var r=cc.instantiate(this.gridPrefab);r.parent=this.container,r.setPosition(this.grids[n][s].pos),r.getComponent("Grid").init(this.grids[n][s],this),i++,this.gridList.push(this.grids[n][s])}}},createRandomGrids:function(t){var e,i=this;this.previousDeleteGrids=null;var n=this.getNullGrids(),s=n.length>t?t:n.length;this.checkCount=s,this.currentCheckCount=0;for(var r=function(s){var r=void 0;r=10===t?i.randomNumberList[Math.floor(Math.random()*i.randomNumberList.length)]:i.randomHoneyNumList[s],e=i.honeyPool.length>0?i.honeyPool.pop():cc.instantiate(i.honeyPrefab);var o=(n=i.getNullGrids())[Math.floor(Math.random()*n.length)];o.num=r,o.honey=e,e.getComponent("Honey").show(i.container,o),setTimeout(function(){i.checkMerge(o)},1)},o=0;o<s;o++)r(o);5===t&&this.preloadHoneyNum(!1)},checkMerge:function(t){this.previousDeleteGrids&&this.previousDeleteGrids.indexOf(t)>=0?(this.currentCheckCount++,this.currentCheckCount>=this.checkCount&&0===this.getNullGrids().length&&this.gameOver()):(this.previousDeleteGrids=this.getGroup(t),this.previousDeleteGrids.length>=4?this.mergeHoney(t,this.previousDeleteGrids):(this.currentCheckCount++,this.currentCheckCount>=this.checkCount&&0===this.getNullGrids().length&&this.gameOver()))},gameOver:function(){this.gameOverNode.active=!0,this.gameOverNode.setScale(0,0),cc.tween(this.gameOverNode).to(1,{scale:1},{easing:"elasticOut"}).start()},getNullGrids:function(){for(var t=[],e=0;e<this.gridList.length;e++)null==this.gridList[e].honey&&t.push(this.gridList[e]);return t},startMove:function(t){this.currentMoveGrid=t},move:function(){},endMove:function(t){if(this.currentMoveGrid){if(this.honey=this.currentMoveGrid.honey,this.path=this.getPath(this.currentMoveGrid,t),null==this.path)return void this.restoreHoney();this.currentMoveGrid.honey=null,t.honey=this.honey,t.num=this.currentMoveGrid.num,this.currentMoveGrid.num=0;var e,i=cc.callFunc(function(){var e=this.getGroup(t);e.length>=4?this.mergeHoney(t,e):this.createRandomGrids(5)},this),n=[];if(this.path.length>1){for(var s=0;s<this.path.length;s++){var r=this.path[s].pos,o=cc.moveTo(.05,cc.v2(r.x,r.y));n.push(o)}n.push(i),e=cc.sequence(n),this.honey.runAction(e)}else{n=[cc.moveTo(.05,cc.v2(this.path[0].pos.x,this.path[0].pos.y)),i],e=cc.sequence(n),this.honey.runAction(e)}this.currentMoveGrid.grid.stopHight(),this.currentMoveGrid=null}},restoreHoney:function(){null!=this.currentMoveGrid&&this.currentMoveGrid.grid.stopHight()},mergeHoney:function(t,e){var i=this,n=4*t.num;this.mergeCount=e.length-1;for(var s=0;s<e.length;s++){var r=e[s];r!=t&&(cc.tween(r.honey).to(.5,{position:cc.v2(t.pos.x,t.pos.y)},{easing:"elasticIn"}).call(function(e){i.mergeCount--,e.parent=null,i.honeyPool.push(e),i.mergeCount<=0&&cc.tween(t.honey).to(.8,{scale:0},{easing:"elasticIn"}).call(function(){t.num=n,t.honey.getComponent("Honey").setLabel(n),cc.tween(t.honey).to(.8,{scale:1},{easing:"elasticOut"}).call(function(){i.previousDeleteGrids=null,i.checkMerge(t),i.currentCoin++,i.currentScore+=n,i.coinLabel.string="COIN: "+i.currentCoin,i.scoreLabel.string="SCORE: "+i.currentScore,i.gameOverScoreLabel.string=i.currentScore}).start()}).start()}).start(),r.honey=null,r.num=0)}},getPath:function(t,e){for(var i=0;i<this.gridList.length;i++){this.gridList[i].parentGrid=null}var n;for(this.openList=[t],this.closeList=[];;){var s=this.getMinNode(t,e);if(this.closeList.push(s),n=this.openList.indexOf(s),this.openList.splice(n,1),this.openList=this.openList.concat(this.getRoundNode(s)),s==e)for(var r=s,o=[];;){if(!r.parentGrid)return o.reverse();o.push(r),r=r.parentGrid}if(0===this.openList.length)return null}},filterGrid:function(t){var e=this.openList.indexOf(t),i=this.closeList.indexOf(t);return e<0&&i<0},getRoundNode:function(t,e){var i=t.row,n=t.col,s=i>0?this.grids[i-1]:null,r=this.grids[i],o=i<8?this.grids[i+1]:null,h=[];return r&&(n>0&&(e||null==r[n-1].honey&&this.filterGrid(r[n-1]))&&(1!=e&&(r[n-1].parentGrid=t),h.push(r[n-1])),n<r.length-1&&(e||null==r[n+1].honey&&this.filterGrid(r[n+1]))&&(1!=e&&(r[n+1].parentGrid=t),h.push(r[n+1]))),s&&(s.length>this.grids[i].length?(e||null==s[n].honey&&this.filterGrid(s[n]))&&(1!=e&&(s[n].parentGrid=t),h.push(s[n])):n>0&&(e||null==s[n-1].honey&&this.filterGrid(s[n-1]))&&(1!=e&&(s[n-1].parentGrid=t),h.push(s[n-1])),s.length>this.grids[i].length?(e||null==s[n+1].honey&&this.filterGrid(s[n+1]))&&(1!=e&&(s[n+1].parentGrid=t),h.push(s[n+1])):n<this.grids[i].length-1&&(e||null==s[n].honey&&this.filterGrid(s[n]))&&(1!=e&&(s[n].parentGrid=t),h.push(s[n]))),o&&(o.length>this.grids[i].length?(e||null==o[n].honey&&this.filterGrid(o[n]))&&(1!=e&&(o[n].parentGrid=t),h.push(o[n])):n>0&&(e||null==o[n-1].honey&&this.filterGrid(o[n-1]))&&(1!=e&&(o[n-1].parentGrid=t),h.push(o[n-1])),o.length>this.grids[i].length?(e||null==o[n+1].honey&&this.filterGrid(o[n+1]))&&(1!=e&&(o[n+1].parentGrid=t),h.push(o[n+1])):n<this.grids[i].length-1&&(e||null==o[n].honey&&this.filterGrid(o[n]))&&(1!=e&&(o[n].parentGrid=t),h.push(o[n]))),h},getMinNode:function(t,e){var i=this.openList[0],n=this.getValue(t,e,i);i.pathValue=n;for(var s=1;s<this.openList.length;s++){var r=this.getValue(t,e,this.openList[s]);this.openList[s].pathValue=r,r<n&&(i=this.openList[s],n=r)}return i},getValue:function(t,e,i){return this.getDis(t.pos,i.pos)+this.getDis(i.pos,e.pos)},getDis:function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},getGroup:function(t){for(var e,i=t,n=[],s=[t];;){e=this.getRoundNode(i,!0);for(var r=0;r<e.length;r++)e[r].num===t.num&&n.indexOf(e[r])<0&&s.indexOf(e[r])<0&&(n.push(e[r]),s.indexOf(e[r])<0&&s.push(e[r]));if(0===n.length)return s;i=n.pop()}return null},start:function(){},update:function(t){}}),cc._RF.pop()},{}]},{},["Grid","Honey","MainGame"]);